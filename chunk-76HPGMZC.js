import{a as ve}from"./chunk-NINX4UDH.js";import{a as de,d as ue,e as _e,f as fe,g as he,h as Ce}from"./chunk-N674FEQB.js";import"./chunk-JTXMDS4E.js";import"./chunk-2TFTJWQW.js";import"./chunk-GLG5OO3S.js";import{b as le,c as pe,d as se,e as me,i as ce}from"./chunk-NHAPQC3W.js";import"./chunk-KFFE56HM.js";import{a as ge}from"./chunk-G255QGHI.js";import"./chunk-NUGAOAR2.js";import{b as q,c as G,d as K,e as X}from"./chunk-6HYSLB2P.js";import{i as oe,j as re}from"./chunk-LC6JGRRQ.js";import"./chunk-2WKEWB2B.js";import{E as ae,F as ne,j as ee,l as te,s as ie}from"./chunk-3T4WVZA5.js";import"./chunk-F2X3VGZZ.js";import{d as U,j as J}from"./chunk-THLIJB7Y.js";import{aa as Y,ea as Z}from"./chunk-AAQOC4TC.js";import{r as Q}from"./chunk-F7YKD2CL.js";import{$ as S,Aa as a,Cb as E,Fa as C,Ia as L,Jb as B,Kb as z,Lb as N,Ma as O,Mb as r,N as $,Nb as _,Ob as f,Sa as I,T as k,_ as v,cb as l,cc as m,dc as c,fc as x,ib as F,kb as j,lb as V,ma as b,mb as A,n as P,nb as n,ob as o,pb as d,sc as W,tb as w,tc as H,yb as T,zb as s}from"./chunk-J6TCZN46.js";import{a as M}from"./chunk-C6Q5SG76.js";var R=class t{#e=ge.URL_API;http=k(U);getAllWarehouses=i=>this.http.post(`${this.#e}inventarios/all_filter`,i);static \u0275fac=function(e){return new(e||t)};static \u0275prov=$({token:t,factory:t.\u0275fac,providedIn:"root"})};var ye=["dt1"],be=["filter"],Ie=(t,i)=>i.field;function we(t,i){if(t&1){let e=w();n(0,"div",9)(1,"p-button",10),m(2,"translate"),T("click",function(){v(e);let h=s(),g=N(4);return S(h.clear(g))}),o()()}t&2&&(a(),l("label",c(2,2,"labels.clear"))("outlined",!0))}function Te(t,i){t&1&&(n(0,"th",13)(1,"div",18),r(2),m(3,"translate"),m(4,"uppercase"),d(5,"p-sortIcon",19),o()()),t&2&&(l("pSortableColumn","id"),a(2),f("",c(4,5,c(3,3,"labels.id"))," "),a(3),l("field","id"))}function Ee(t,i){if(t&1&&(n(0,"th",14)(1,"div",18),r(2),m(3,"translate"),m(4,"uppercase"),d(5,"p-sortIcon",19),o()()),t&2){let e=s().$implicit;E("pSortableColumn",e.field),a(2),f("",c(4,5,c(3,3,"labels.idLote"))," "),a(3),l("field",e.field)}}function We(t,i){if(t&1&&(n(0,"th",15)(1,"div",18),r(2),m(3,"translate"),m(4,"uppercase"),d(5,"p-sortIcon",19),o()()),t&2){let e=s().$implicit;E("pSortableColumn",e.field),a(2),f("",c(4,5,c(3,3,"labels.producto"))," "),a(3),l("field",e.field)}}function Re(t,i){if(t&1&&(n(0,"th",15)(1,"div",18),r(2),m(3,"translate"),m(4,"uppercase"),d(5,"p-sortIcon",19),o()()),t&2){let e=s().$implicit;E("pSortableColumn",e.field),a(2),f("",c(4,5,c(3,3,"labels.almacen"))," "),a(3),l("field",e.field)}}function Me(t,i){if(t&1&&(n(0,"th",16)(1,"div",18),r(2),m(3,"translate"),m(4,"uppercase"),d(5,"p-sortIcon",19),o()()),t&2){let e=s().$implicit;l("pSortableColumn",e.field),a(2),f("",c(4,5,c(3,3,"labels.cantreserv"))," "),a(3),l("field",e.field)}}function Le(t,i){if(t&1&&(n(0,"th",16)(1,"div",18),r(2),m(3,"translate"),m(4,"uppercase"),d(5,"p-sortIcon",19),o()()),t&2){let e=s().$implicit;l("pSortableColumn",e.field),a(2),f("",c(4,5,c(3,3,"labels.cantidadDespachada"))," "),a(3),l("field",e.field)}}function Fe(t,i){if(t&1&&(n(0,"th",17)(1,"div",18),r(2),m(3,"uppercase"),d(4,"p-sortIcon",19),o()()),t&2){let e=s().$implicit;l("pSortableColumn",e.field),a(2),f("",c(3,3,e.field)," "),a(2),l("field",e.field)}}function Ve(t,i){if(t&1&&I(0,Te,6,7,"th",13)(1,Ee,6,7,"th",14)(2,We,6,7,"th",15)(3,Re,6,7,"th",15)(4,Me,6,7,"th",16)(5,Le,6,7,"th",16)(6,Fe,5,5,"th",17),t&2){let e,p=i.$implicit;F((e=p.field)==="id"?0:e==="idLote"?1:e==="producto"?2:e==="almacen"?3:e==="cantidadReservada"?4:e==="cantidadDespachada"?5:6)}}function Ae(t,i){if(t&1&&d(0,"appcommon-filter-input",20),t&2){let e=s().$implicit;l("field",e.field)}}function Be(t,i){if(t&1&&d(0,"appcommon-filter-input",21),t&2){let e=s().$implicit;l("field",e.field)}}function De(t,i){if(t&1&&d(0,"appcommon-filter-input",20),t&2){let e=s().$implicit;l("field",e.field)}}function Pe(t,i){if(t&1&&d(0,"appcommon-filter-input",20),t&2){let e=s().$implicit;l("field",e.field)}}function $e(t,i){if(t&1&&d(0,"appcommon-filter-input",20),t&2){let e=s().$implicit;l("field",e.field)}}function ke(t,i){if(t&1&&d(0,"appcommon-filter-input",21),t&2){let e=s().$implicit;l("field",e.field)}}function Oe(t,i){if(t&1&&(n(0,"th"),I(1,Ae,1,1,"appcommon-filter-input",20)(2,Be,1,1,"appcommon-filter-input",21)(3,De,1,1,"appcommon-filter-input",20)(4,Pe,1,1,"appcommon-filter-input",20)(5,$e,1,1,"appcommon-filter-input",20)(6,ke,1,1,"appcommon-filter-input",21),o()),t&2){let e,p=i.$implicit;a(),F((e=p.field)==="idLote"?1:e==="nombreProducto"?2:e==="cantidadStock"?3:e==="cantidadDespachada"?4:e==="cantidadReservada"?5:6)}}function je(t,i){t&1&&(n(0,"th",12),r(1,"cargando"),o())}function ze(t,i){if(t&1&&(n(0,"tr"),d(1,"th",11),V(2,Ve,7,1,null,null,Ie),o(),n(4,"tr"),V(5,Oe,7,1,"th",null,j,!1,je,2,0,"th",12),o()),t&2){let e=i.$implicit;a(2),A(e),a(3),A(e)}}function Ne(t,i){if(t&1&&(n(0,"tr"),d(1,"td"),n(2,"td"),r(3),o(),n(4,"td"),r(5),o(),n(6,"td"),r(7),o(),n(8,"td"),r(9),o(),n(10,"td"),r(11),o(),n(12,"td"),r(13),o(),n(14,"td"),r(15),o(),n(16,"td"),r(17),o(),n(18,"td"),r(19),o(),n(20,"td",22),r(21),o(),n(22,"td",22),r(23),o(),n(24,"td"),r(25),o(),n(26,"td",22),r(27),o()()),t&2){let e=i.$implicit;a(3),_(e.id),a(2),_(e.idLote),a(2),_(e.nombreProducto),a(2),_(e.almacen==null?null:e.almacen.nombre),a(2),_(e.cantidadStock),a(2),f("Despachada: ",e.cantidadDespachada,""),a(2),f("Reservada: ",e.cantidadReservada,""),a(2),_(e.totalDisponible),a(2),_(e.cant_transferencias),a(2),_(e.precio_compra),a(2),_(e.precio_venta),a(2),_(e.sucursal),a(2),_(e.stock)}}function He(t,i){if(t&1){let e=w();n(0,"div",23)(1,"p-multiSelect",24),T("onChange",function(h){v(e);let g=s();return S(g.cargaColumnas(h))})("onSelectAllChange",function(h){v(e);let g=s();return S(g.selectAll(h))}),o()()}if(t&2){let e=s();a(),l("options",e.colsOptionsSelect)("ngModel",e.columnsSelectSignal())}}function Qe(t,i){t&1&&(n(0,"tr")(1,"td",25),r(2,"No order found."),o()())}function Ue(t,i){t&1&&(n(0,"tr")(1,"td",25),r(2,"Loading orders data. Please wait."),o()())}var D=class t{constructor(i,e,p,h,g,y,Je){this.inventaryServ=i;this.filterservice=e;this.translate=p;this.translateLanService=h;this.messageService=g;this.router=y;this.arrayurilservice=Je;this.translateLanService.changeLanguage$.subscribe(u=>this.translate.use(u)),H(()=>{this.inventaryServ.getAllWarehouses(this.warehousesdto()).pipe(P(u=>({data:Array.isArray(u.data)?[...u.data]:[],metadata:{page:u.metadata.page,rows:u.metadata.rows,total_records:u.metadata.total_records},loading:!1,error:null}))).subscribe({next:u=>{console.log(u),console.log(M({},this.warehousesdto())),this.stateValues.set(u),console.log(this.stateValues())},error:u=>{this.stateValues.set({data:[],metadata:{page:0,rows:0,total_records:0},loading:!1,error:u}),console.log("console.log('', err):   ",u,this.stateValues())},complete:()=>{console.log("console.log('', this.stateValues()):   ",this.stateValues())}})})}table=L("dt1");filter=L("filter");stateValues=b({data:[],metadata:{page:0,rows:0,total_records:0},loading:!0,error:null});searchTxt=b([]);warehousesdto=b({config:{populate_data:!0,page:1,rows:15,sort_field:[]},filter:{}});tablecon=de.cantidadRegistros;stateIni=!1;keylocalColumn="inventory_cols";allowedColumns=["id","idLote","producto","almacen","cantidadStock","totalDisponible","cantidadDespachada","cant_salidas","cant_transferencias","precio_compra","precio_venta","sucursal"];columns=this.allowedColumns;columnsSelectSignal=W(()=>this.columns.map(i=>({field:i,header:i.charAt(0).toUpperCase()+i.slice(1)})));colsOptionsSelect=this.allowedColumns.map(i=>({field:i,header:i.charAt(0).toUpperCase()+i.slice(1)}));expandedRows={};clear=i=>{i.clear()};onColumnReorder=i=>localStorage.setItem(this.keylocalColumn,JSON.stringify(i.columns));getDataPaged(i){i.filters&&this.stateIni!==!1&&this.warehousesdto.update(()=>({config:{populate_data:!1,page:(i.first||0)/Number(i.rows)+1,sort_field:i.multiSortMeta?i.multiSortMeta.filter(e=>e.field):[],rows:Number(i.rows)},filter:M({},this.filterservice.applyFilterNew(i.filters,this.warehousesdto().filter))})),this.stateIni=!0}cargaColumnas(i){let e=this.arrayurilservice.selectOrderedArray(this.colsOptionsSelect,i.value);this.columnsSelectSignal=W(()=>e),localStorage.setItem(this.keylocalColumn,JSON.stringify(this.columnsSelectSignal()))}selectAll(i){let e=[];i.checked&&(e=this.allowedColumns),this.columnsSelectSignal=W(()=>e),localStorage.setItem(this.keylocalColumn,JSON.stringify(e))}static \u0275fac=function(e){return new(e||t)(C(R),C(Ce),C(q),C(X),C(Y),C(J),C(ve))};static \u0275cmp=O({type:t,selectors:[["app-inventory"]],viewQuery:function(e,p){e&1&&(B(p.table,ye,5),B(p.filter,be,5)),e&2&&z(2)},decls:16,vars:20,consts:[["dt1",""],["header",""],["body",""],["paginatorleft",""],["emptymessage",""],["loadingbody",""],[3,"header"],["datakey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} items","styleClass","p-datatable-sm p-datatable-gridlines p-0 m-0","responsiveLayout","scroll","scrollHeight","70vh",3,"onColReorder","onLazyLoad","value","paginator","rows","loading","rowHover","rowsPerPageOptions","lazy","columns","reorderableColumns","totalRecords","sortMode","customSort","scrollable","paginatorPosition","showCurrentPageReport"],["pTemplate","caption"],[1,"flex","flex-wrap","justify-content-end","gap-2"],["icon","pi pi-filter-slash",3,"click","label","outlined"],["rowspan","2"],[2,"min-width","8rem"],["pReorderableColumn","",2,"min-width","1rem",3,"pSortableColumn"],["pReorderableColumn","",2,"min-width","8rem",3,"pSortableColumn"],["pReorderableColumn","",2,"min-width","20rem",3,"pSortableColumn"],["pReorderableColumn","",2,"min-width","10rem",3,"pSortableColumn"],["pReorderableColumn","",3,"pSortableColumn"],[1,"flex","justify-content-between","align-items-left"],[3,"field"],["type","number",3,"field"],["type","text",3,"field"],[1,"text-right"],[1,"flex","align-items-center","justify-content-center"],["inputId","float-label","optionLabel","header","selectedItemsLabel","{0} columns selected","size","small","placeholder","Choose Columns",1,"p-input-icon-left",3,"onChange","onSelectAllChange","options","ngModel"],["colspan","8"]],template:function(e,p){if(e&1){let h=w();n(0,"p-card",6),m(1,"translate"),m(2,"uppercase"),n(3,"p-table",7,0),T("onColReorder",function(y){return v(h),S(p.onColumnReorder(y))})("onLazyLoad",function(y){return v(h),S(p.getDataPaged(y))}),I(5,we,3,4,"ng-template",8)(6,ze,8,1,"ng-template",null,1,x)(8,Ne,28,13,"ng-template",null,2,x)(10,He,2,2,"ng-template",null,3,x)(12,Qe,3,0,"ng-template",null,4,x)(14,Ue,3,0,"ng-template",null,5,x),o()()}e&2&&(l("header",c(2,18,c(1,16,"pages.inventories"))),a(3),l("value",p.stateValues().data)("paginator",!0)("rows",p.stateValues().metadata.rows)("loading",p.stateValues().loading)("rowHover",!0)("rowsPerPageOptions",p.tablecon)("lazy",!0)("columns",p.columnsSelectSignal())("reorderableColumns",!0)("totalRecords",p.stateValues().metadata.total_records)("sortMode","multiple")("customSort",!0)("scrollable",!0)("paginatorPosition","bottom")("showCurrentPageReport",!0))},dependencies:[re,oe,Z,ne,ae,K,G,Q,ce,le,pe,me,se,he,fe,_e,ue,ie,ee,te],encapsulation:2,changeDetection:0})};export{D as default};
