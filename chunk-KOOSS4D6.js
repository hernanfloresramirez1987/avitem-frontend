import{a as ve}from"./chunk-NINX4UDH.js";import{a as de,d as ue,e as _e,f as fe,g as he,h as Ce}from"./chunk-N674FEQB.js";import"./chunk-JTXMDS4E.js";import"./chunk-2TFTJWQW.js";import"./chunk-GLG5OO3S.js";import{b as le,c as pe,d as se,e as me,i as ce}from"./chunk-NHAPQC3W.js";import"./chunk-KFFE56HM.js";import{a as ge}from"./chunk-G255QGHI.js";import"./chunk-NUGAOAR2.js";import{b as q,c as G,d as K,e as X}from"./chunk-6HYSLB2P.js";import{i as oe,j as re}from"./chunk-LC6JGRRQ.js";import"./chunk-2WKEWB2B.js";import{E as ne,F as ae,j as ee,l as te,s as ie}from"./chunk-3T4WVZA5.js";import"./chunk-F2X3VGZZ.js";import{d as U,j as J}from"./chunk-THLIJB7Y.js";import{aa as Y,ea as Z}from"./chunk-AAQOC4TC.js";import{r as Q}from"./chunk-F7YKD2CL.js";import{$ as S,Aa as n,Cb as E,Fa as g,Ia as L,Jb as B,Kb as z,Lb as N,Ma as O,Mb as r,N as D,Nb as u,Ob as C,Sa as I,T as k,_ as v,cb as l,cc as s,dc as m,fc as x,ib as F,kb as j,lb as V,ma as b,mb as A,n as $,nb as a,ob as o,pb as d,sc as W,tb as w,tc as H,yb as T,zb as c}from"./chunk-J6TCZN46.js";import{a as M}from"./chunk-C6Q5SG76.js";var R=class t{#e=ge.URL_API;http=k(U);getAllWarehouses=i=>this.http.post(`${this.#e}inventarios/all_filter`,i);static \u0275fac=function(e){return new(e||t)};static \u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"})};var ye=["dt1"],be=["filter"],Ie=(t,i)=>i.field;function we(t,i){if(t&1){let e=w();a(0,"div",9)(1,"p-button",10),s(2,"translate"),T("click",function(){v(e);let f=c(),h=N(5);return S(f.clear(h))}),o()()}t&2&&(n(),l("label",m(2,2,"labels.clear"))("outlined",!0))}function Te(t,i){t&1&&(a(0,"th",13)(1,"div",18),r(2),s(3,"translate"),s(4,"uppercase"),d(5,"p-sortIcon",19),o()()),t&2&&(l("pSortableColumn","id"),n(2),C("",m(4,5,m(3,3,"labels.id"))," "),n(3),l("field","id"))}function Ee(t,i){if(t&1&&(a(0,"th",14)(1,"div",18),r(2),s(3,"translate"),s(4,"uppercase"),d(5,"p-sortIcon",19),o()()),t&2){let e=c().$implicit;E("pSortableColumn",e.field),n(2),C("",m(4,5,m(3,3,"labels.idLote"))," "),n(3),l("field",e.field)}}function We(t,i){if(t&1&&(a(0,"th",15)(1,"div",18),r(2),s(3,"translate"),s(4,"uppercase"),d(5,"p-sortIcon",19),o()()),t&2){let e=c().$implicit;E("pSortableColumn",e.field),n(2),C("",m(4,5,m(3,3,"labels.producto"))," "),n(3),l("field",e.field)}}function Re(t,i){if(t&1&&(a(0,"th",15)(1,"div",18),r(2),s(3,"translate"),s(4,"uppercase"),d(5,"p-sortIcon",19),o()()),t&2){let e=c().$implicit;E("pSortableColumn",e.field),n(2),C("",m(4,5,m(3,3,"labels.almacen"))," "),n(3),l("field",e.field)}}function Me(t,i){if(t&1&&(a(0,"th",16)(1,"div",18),r(2),s(3,"translate"),s(4,"uppercase"),d(5,"p-sortIcon",19),o()()),t&2){let e=c().$implicit;l("pSortableColumn",e.field),n(2),C("",m(4,5,m(3,3,"labels.cantreserv"))," "),n(3),l("field",e.field)}}function Le(t,i){if(t&1&&(a(0,"th",16)(1,"div",18),r(2),s(3,"translate"),s(4,"uppercase"),d(5,"p-sortIcon",19),o()()),t&2){let e=c().$implicit;l("pSortableColumn",e.field),n(2),C("",m(4,5,m(3,3,"labels.cantidadDespachada"))," "),n(3),l("field",e.field)}}function Fe(t,i){if(t&1&&(a(0,"th",17)(1,"div",18),r(2),s(3,"uppercase"),d(4,"p-sortIcon",19),o()()),t&2){let e=c().$implicit;l("pSortableColumn",e.field),n(2),C("",m(3,3,e.field)," "),n(2),l("field",e.field)}}function Ve(t,i){if(t&1&&I(0,Te,6,7,"th",13)(1,Ee,6,7,"th",14)(2,We,6,7,"th",15)(3,Re,6,7,"th",15)(4,Me,6,7,"th",16)(5,Le,6,7,"th",16)(6,Fe,5,5,"th",17),t&2){let e,p=i.$implicit;F((e=p.field)==="id"?0:e==="idLote"?1:e==="producto"?2:e==="almacen"?3:e==="cantidadReservada"?4:e==="cantidadDespachada"?5:6)}}function Ae(t,i){if(t&1&&d(0,"appcommon-filter-input",20),t&2){let e=c().$implicit;l("field",e.field)}}function Be(t,i){if(t&1&&d(0,"appcommon-filter-input",21),t&2){let e=c().$implicit;l("field",e.field)}}function Pe(t,i){if(t&1&&d(0,"appcommon-filter-input",20),t&2){let e=c().$implicit;l("field",e.field)}}function $e(t,i){if(t&1&&d(0,"appcommon-filter-input",20),t&2){let e=c().$implicit;l("field",e.field)}}function De(t,i){if(t&1&&d(0,"appcommon-filter-input",20),t&2){let e=c().$implicit;l("field",e.field)}}function ke(t,i){if(t&1&&d(0,"appcommon-filter-input",21),t&2){let e=c().$implicit;l("field",e.field)}}function Oe(t,i){if(t&1&&(a(0,"th"),I(1,Ae,1,1,"appcommon-filter-input",20)(2,Be,1,1,"appcommon-filter-input",21)(3,Pe,1,1,"appcommon-filter-input",20)(4,$e,1,1,"appcommon-filter-input",20)(5,De,1,1,"appcommon-filter-input",20)(6,ke,1,1,"appcommon-filter-input",21),o()),t&2){let e,p=i.$implicit;n(),F((e=p.field)==="idLote"?1:e==="nombreProducto"?2:e==="cantidadStock"?3:e==="cantidadDespachada"?4:e==="cantidadReservada"?5:6)}}function je(t,i){t&1&&(a(0,"th",12),r(1,"cargando"),o())}function ze(t,i){if(t&1&&(a(0,"tr"),d(1,"th",11),V(2,Ve,7,1,null,null,Ie),o(),a(4,"tr"),V(5,Oe,7,1,"th",null,j,!1,je,2,0,"th",12),o()),t&2){let e=i.$implicit;n(2),A(e),n(3),A(e)}}function Ne(t,i){if(t&1&&(a(0,"tr"),d(1,"td"),a(2,"td"),r(3),o(),a(4,"td"),r(5),o(),a(6,"td"),r(7),o(),a(8,"td"),r(9),o(),a(10,"td"),r(11),o(),a(12,"td"),r(13),o(),a(14,"td"),r(15),o(),a(16,"td"),r(17),o(),a(18,"td"),r(19),o(),a(20,"td",22),r(21),o(),a(22,"td",22),r(23),o(),a(24,"td"),r(25),o(),a(26,"td",22),r(27),o()()),t&2){let e=i.$implicit;n(3),u(e.id),n(2),u(e.idLote),n(2),u(e.nombreProducto),n(2),u(e.almacen==null?null:e.almacen.nombre),n(2),u(e.cantidadStock),n(2),u(e.cantidadDespachada),n(2),u(e.cantidadReservada),n(2),u(e.totalDisponible),n(2),u(e.cant_transferencias),n(2),u(e.precio_compra),n(2),u(e.precio_venta),n(2),u(e.sucursal),n(2),u(e.stock)}}function He(t,i){if(t&1){let e=w();a(0,"div",23)(1,"p-multiSelect",24),T("onChange",function(f){v(e);let h=c();return S(h.cargaColumnas(f))})("onSelectAllChange",function(f){v(e);let h=c();return S(h.selectAll(f))}),o()()}if(t&2){let e=c();n(),l("options",e.colsOptionsSelect)("ngModel",e.columnsSelectSignal())}}function Qe(t,i){t&1&&(a(0,"tr")(1,"td",25),r(2,"No order found."),o()())}function Ue(t,i){t&1&&(a(0,"tr")(1,"td",25),r(2,"Loading orders data. Please wait."),o()())}var P=class t{constructor(i,e,p,f,h,y,Je){this.inventaryServ=i;this.filterservice=e;this.translate=p;this.translateLanService=f;this.messageService=h;this.router=y;this.arrayurilservice=Je;this.translateLanService.changeLanguage$.subscribe(_=>this.translate.use(_)),H(()=>{this.inventaryServ.getAllWarehouses(this.warehousesdto()).pipe($(_=>({data:Array.isArray(_.data)?[..._.data]:[],metadata:{page:_.metadata.page,rows:_.metadata.rows,total_records:_.metadata.total_records},loading:!1,error:null}))).subscribe({next:_=>{console.log(_),console.log(M({},this.warehousesdto())),this.stateValues.set(_),console.log(this.stateValues())},error:_=>{this.stateValues.set({data:[],metadata:{page:0,rows:0,total_records:0},loading:!1,error:_}),console.log("console.log('', err):   ",_,this.stateValues())},complete:()=>{console.log("console.log('', this.stateValues()):   ",this.stateValues())}})})}table=L("dt1");filter=L("filter");stateValues=b({data:[],metadata:{page:0,rows:0,total_records:0},loading:!0,error:null});searchTxt=b([]);warehousesdto=b({config:{populate_data:!0,page:1,rows:15,sort_field:[]},filter:{}});tablecon=de.cantidadRegistros;stateIni=!1;title="pages.inventories";subtitle="labels.view_historie";allowedColumns=["id","idLote","producto","almacen","cantidadStock","totalDisponible","cantidadDespachada","cant_salidas","cant_transferencias","precio_compra","precio_venta","sucursal"];columns=this.allowedColumns;columnsSelectSignal=W(()=>this.columns.map(i=>({field:i,header:i.charAt(0).toUpperCase()+i.slice(1)})));colsOptionsSelect=this.allowedColumns.map(i=>({field:i,header:i.charAt(0).toUpperCase()+i.slice(1)}));expandedRows={};keylocalColumn="inventory_cols";clear=i=>{i.clear()};onColumnReorder=i=>localStorage.setItem(this.keylocalColumn,JSON.stringify(i.columns));getDataPaged(i){i.filters&&this.stateIni!==!1&&this.warehousesdto.update(()=>({config:{populate_data:!1,page:(i.first||0)/Number(i.rows)+1,sort_field:i.multiSortMeta?i.multiSortMeta.filter(e=>e.field):[],rows:Number(i.rows)},filter:M({},this.filterservice.applyFilterNew(i.filters,this.warehousesdto().filter))})),this.stateIni=!0}cargaColumnas(i){let e=this.arrayurilservice.selectOrderedArray(this.colsOptionsSelect,i.value);this.columnsSelectSignal=W(()=>e),localStorage.setItem(this.keylocalColumn,JSON.stringify(this.columnsSelectSignal()))}selectAll(i){let e=[];i.checked&&(e=this.allowedColumns),this.columnsSelectSignal=W(()=>e),localStorage.setItem(this.keylocalColumn,JSON.stringify(e))}static \u0275fac=function(e){return new(e||t)(g(R),g(Ce),g(q),g(X),g(Y),g(J),g(ve))};static \u0275cmp=O({type:t,selectors:[["app-inventory"]],viewQuery:function(e,p){e&1&&(B(p.table,ye,5),B(p.filter,be,5)),e&2&&z(2)},decls:17,vars:23,consts:[["dt1",""],["header",""],["body",""],["paginatorleft",""],["emptymessage",""],["loadingbody",""],[3,"header","subheader"],["datakey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} items","styleClass","p-datatable-sm p-datatable-gridlines p-0 m-0","responsiveLayout","scroll","scrollHeight","70vh",3,"onColReorder","onLazyLoad","value","paginator","rows","loading","rowHover","rowsPerPageOptions","lazy","columns","reorderableColumns","totalRecords","sortMode","customSort","scrollable","paginatorPosition","showCurrentPageReport"],["pTemplate","caption"],[1,"flex","flex-wrap","justify-content-end","gap-2"],["icon","pi pi-filter-slash",3,"click","label","outlined"],["rowspan","2"],[2,"min-width","8rem"],["pReorderableColumn","",2,"min-width","1rem",3,"pSortableColumn"],["pReorderableColumn","",2,"min-width","8rem",3,"pSortableColumn"],["pReorderableColumn","",2,"min-width","20rem",3,"pSortableColumn"],["pReorderableColumn","",2,"min-width","10rem",3,"pSortableColumn"],["pReorderableColumn","",3,"pSortableColumn"],[1,"flex","justify-content-between","align-items-left"],[3,"field"],["type","number",3,"field"],["type","text",3,"field"],[1,"text-right"],[1,"flex","align-items-center","justify-content-center"],["inputId","float-label","optionLabel","header","selectedItemsLabel","{0} columns selected","size","small","placeholder","Choose Columns",1,"p-input-icon-left",3,"onChange","onSelectAllChange","options","ngModel"],["colspan","8"]],template:function(e,p){if(e&1){let f=w();a(0,"p-card",6),s(1,"translate"),s(2,"uppercase"),s(3,"translate"),a(4,"p-table",7,0),T("onColReorder",function(y){return v(f),S(p.onColumnReorder(y))})("onLazyLoad",function(y){return v(f),S(p.getDataPaged(y))}),I(6,we,3,4,"ng-template",8)(7,ze,8,1,"ng-template",null,1,x)(9,Ne,28,13,"ng-template",null,2,x)(11,He,2,2,"ng-template",null,3,x)(13,Qe,3,0,"ng-template",null,4,x)(15,Ue,3,0,"ng-template",null,5,x),o()()}e&2&&(l("header",m(2,19,m(1,17,p.title)))("subheader",m(3,21,p.subtitle)),n(4),l("value",p.stateValues().data)("paginator",!0)("rows",p.stateValues().metadata.rows)("loading",p.stateValues().loading)("rowHover",!0)("rowsPerPageOptions",p.tablecon)("lazy",!0)("columns",p.columnsSelectSignal())("reorderableColumns",!0)("totalRecords",p.stateValues().metadata.total_records)("sortMode","multiple")("customSort",!0)("scrollable",!0)("paginatorPosition","bottom")("showCurrentPageReport",!0))},dependencies:[re,oe,Z,ae,ne,K,G,Q,ce,le,pe,me,se,he,fe,_e,ue,ie,ee,te],encapsulation:2,changeDetection:0})};export{P as default};
